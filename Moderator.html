<html><head><title>Moderator</title><script>
function start(){var e=prompt("Text?").replace(/[\u200B-\u200D\uFEFF]/g,"");e=(e=(e=(e=(e=(e=(e=(e=(e=e.replaceAll("\r\n\r\n","\n\n")).replaceAll("\r\n","\n\n")).replaceAll("\n\na. BONUS:","\n\nBONUS:")).replaceAll("\n\nb. BONUS:","\n\nBONUS:")).replaceAll("\n\nBonus 1","\n\nBonus")).replaceAll("\n\nBonus 2","\n\nBonus")).replaceAll("\n\nBonus.","\n\nBONUS:")).replace(/(\n\npause for score-check)/gi,"")).replace(/(pause for score update)/gi,"").replace(/(\n\n**score check**)/gi,"");for(var n=["\n\n***I***. TOSSUP:","\n\n***I***. WRITE-DOWN:","\n\nToss-up ***I***:","\n\nWRITE-DOWN ***I***:","\n\nToss-up #***I***:","\n\nWRITE-DOWN #***I***:","\n\nTossup ***I***:","\n\nWRITE DOWN ***I***:","\n\n***I***. Tossup.","\n\n***I***. TOSSUP.","\n\n***I***. TOSS UP:","\n\nTOSS-UP ***I***:","\n\nTOSS UP ***I***:","\n\n***I***. Toss-up:","\n\n***I***) TOSS-UP:","\n\n***I***) WRITE-DOWN:","\n\n***I***) Toss-Up:","\n\n***I***:\n\nTU:","\n\n***I***."],t=["Q***S***I***. Tossup:","Q***S**WR** ***I***:","Q***S***I***. Tossup:","Q***S**WR** ***I***:","Q***S***I***. Tossup:","Q***S**WR** ***I***:","Q***S***I***. Tossup:","Q***S**WR** ***I***:","Q***S***I***. Tossup:","Q***S***I***. Tossup:","Q***S***I***. Tossup:","Q***S***I***. Tossup:","Q***S***I***. Tossup:","Q***S***I***. Tossup:","Q***S***I***. Tossup:","Q***S**WR** ***I***:","Q***S***I***. Tossup:","Q***S***I***. Tossup:","Q***S***I***. Tossup:"],l=!1,o=!1,s=0;s<n.length;s++)if(!(l&&-1!==t[s].indexOf("Tossup")||o&&-1!==t[s].indexOf("**WR**"))){for(var r=e,i=0,a=20;a>=1;a--){var p=n[s].replaceAll("***I***",a);i+=r.split(p).length-1,r=r.replaceAll(p,t[s].replaceAll("***I***",a))}e=r,i>=20&&18===s&&-1!==e.indexOf("Q***S")&&(-1!==t[s].indexOf("Tossup")?l=!0:o=!0)}n=[["\n\nBONUS:","\n\nB1:","\n\nB2:"],["\n\nBONUS:","\n\nBO:"],["\n\nBONUS:","\n\nBO."],["BONUS:","\n\nA.","\n\nB."],["\n\nBONUS:","\n\na.","\n\nb."],["***ANS:","A:"]];if((e.match(/ANS/g)||[]).length+(e.match(/BONUS/gi)||[]).length<=15)for(s=0;s<n.length;s++){for(r=e,i=0,a=1;a<n[s].length;a++)i+=r.split(n[s][a]).length-1,r=r.replaceAll(n[s][a],n[s][0]);if(i>=7&&(e=r,i>=15))break}var c=e.split("Q***S")[0].toString();if((i=(e.match(/ANS/g)||[]).length)>7){var u=0,d=!1;for(s=(h=c.split("\n\n").map((function(e){return this.pos+=e.length+2}),{pos:0}).slice(0,-1)).length-1;s>1;s--)if(e.split(c.slice(0,h[s])).length-1>1){h=h[s],d=!0;break}d||(h=h[1]),c=c.slice(0,h),e=e.replaceAll(c.slice(0,c.length-2),"")}else{u=1;var h=0;for(s=0;s<e.length;s++)if(-1===e.indexOf(c.slice(0,s),1)){h=s-1;break}c=c.slice(0,h),h>=15&&(e=e.replaceAll(c,""))}i=e.split("Q***S").length;var f,g,m,y,v=[];for(s=0;s<i;s++)v[s]=e.split("Q***S")[s];function S(e){for(var n=0;n<v.length;n++){if(e){v[n]=v[n].replaceAll("BONUS","***PH"),v[n]=v[n].replaceAll("Bonus","***PH");for(var t=v[n].split("***PH").length-1;v[n].split("***PH").length>1;){var l=v[n].slice(0,v[n].slice(0,v[n].indexOf("***PH")).lastIndexOf("\n\n")).lastIndexOf("\n\n")+2;v[n]=v[n].slice(0,l)+"ANS: "+v[n].slice(l),v[n]=v[n].replace("***PH","***BNS")}l=v[n].lastIndexOf("\n\n")+2;v[n]=v[n].slice(0,l)+"ANS: "+v[n].slice(l)}else if(1===u){var o=[];o=v[n].split("\n\n").map((function(e){return this.pos+=e.length+2}),{pos:0}).slice(0,-1);for(var s=0;s<v[n].split("\n\n").length-1;s++){if(s!==o.length-1){var r=!1,i=v[n].slice(o[s],o[s+1]),a=!1;i.split("(").length!==i.split(")").length&&i!==i.toUpperCase()&&(i+=v[n].slice(o[s+1],o[s+2]),a=!0);for(var p=i.replace(/ \([\s\S]*?\)/g,"").replace(/[^a-z ]/gi," ").replace(/\s+/g," ").split(" "),c=(t=0,0);c<p.length;c++)p[c]===p[c].toUpperCase()&&t++;(t/p.length>=.8||t/p.length>=.7&&p.length>5)&&(r=!0,a&&(v[n]=v[n].slice(0,o[s+1])+v[n].slice(o[s+2])))}if(r||s===o.length-1||0===v[n].slice(o[s+1]).indexOf("BONUS"))if(v[n]=v[n].slice(0,o[s])+"ANS: "+v[n].slice(o[s]),a)o=v[n].split("\n\n").map((function(e){return this.pos+=e.length+2}),{pos:0}).slice(0,-1);else for(c=s+1;c<o.length;c++)o[c]+=5}}v[n]=v[n].replaceAll("ANS:","***ANS:"),v[n]=v[n].replaceAll("ANS. ","***ANS: "),1===u&&(v[n]=v[n].replaceAll("Ans.","***ANS:")),v[n]=v[n].replaceAll("\n\nBONUS","***BNS"),v[n]=v[n].replaceAll("\n\nBonus","***BNS"),v[n]=v[n].replaceAll("**WR**","Write-Down"),v[n]=v[n].split("***")}for(n=0;n<v.length;n++)for(s=0;s<v[n].length;s++)v[n][s]=v[n][s].replaceAll("ANS:","Answer:"),v[n][s]=v[n][s].replaceAll("BNS","Bonus"),v[n][s]=v[n][s].replaceAll("\n ","");for(n=0;n<v.length;n++)for(s=0;s<v[n].length;s++)"Answer:\n\n"!==v[n][s]&&"Answer: \n\n"!==v[n][s]&&"Answer: "!==v[n][s]&&"\n\n"!==v[n][s]&&""!==v[n][s]||(v[n].splice(s,1),s--);if(1===u){for(n=0;n<v.length;n++)for(s=0;s<v[n].length-1;s++)"Answer:"===v[n][s].slice(0,7)&&"Answer:"===v[n][s+1].slice(0,7)&&(v[n][s]=v[n][s]+v[n][s+1].slice(8),v[n].splice(s+1,1),s--);for(n=0;n<v.length;n++)for(s=1;s<v[n].length;s++)if(v[n][s].indexOf("Answer:")*v[n][s].indexOf("Bonus:")!=0&&s>3){v[n].splice(s);break}var d=["1. ","2. ","3. ","4. ","5. ","6. ","7. ","8. ","9. ","10.","11.","12.","13.","14.","15.","16.","17.","18.","19.","20.","Wri"];for(n=0;n<v.length;n++)-1===d.indexOf(v[n][0].slice(0,3))&&(v.splice(n,1),n--)}}v=v.splice(1),S();for(s=0;s<v.length;s+=20){var b=0,I=v.slice(s,s+20);for(a=0;a<I.length;a++)3===I[a].length&&b++;if(b>=15){i=e.split("Q***S").length-1;for(v=[],s=0;s<i;s++)v[s]=e.split("Q***S")[s];v=v.splice(1),S(!0);break}}document.write("<html><head></head><body></body></html>"),confirm("Play with defualt settings?")?(f=150,g=!0,m=!0,y=!1):(f=Number(prompt("Your desired moderator speed (ms per letter)?",150)),g=confirm("Display questions sequentially (can be triggered with d)?"),m=confirm("Play bonuses as tossups if no team answers correctly (if you choose no, you can manually trigger this behavior)?"),y=confirm("Always play bonuses as tossups?")),alert("There are three shortcuts usable in this application.\nPress s to skip to a different question\nPress d to show the full question (eliminates the timer)\nPress f to pull up buzz timing statistics\n\nIf you want to give partial credit on a question, you can enter p into the box.\nIf you have manually set the application to not play bonus as tossup, you can still trigger this option by entering nothing into the box after a question.");var w=prompt("There are "+v.length+" questions in this problem set. Put the teams you wish to initialize here (seperated by commas).");w=w.split(",");var x=["q","p","z","m"],T=["w","o","x","n"],A=[[],[],[],[]];for(s=4;s>w.length;s--)x.splice(x.length-1,1),T.splice(T.length-1,1),A.splice(A.length-1,1);var N=document.createElement("div");N.id="question",N.style.position="absolute",N.style.zIndex="9",N.style.border="1px solid #d3d3d3",N.style.display="flex",N.style.margin="0",N.style.padding="0",N.style.overflow="hidden";var O=document.createElement("div");O.id="tableContainer",O.style.position="absolute",O.style.zIndex="9",O.style.border="1px solid #d3d3d3",O.style.display="flex",O.style.margin="0",O.style.padding="0",O.style.resize="both",O.style.top="50%",O.style.overflow="hidden";var B=document.createElement("div");B.id="tableHeader",B.style.cursor="move",B.style.zIndex="10",B.style.backgroundColor="#2196F3",O.appendChild(B);var C=document.createElement("table");C.style.width="100%",C.style.height="100%",C.style.border="1px solid black";var Q=[],W="",k="";for(s=0;s<w.length;s++)Q[s]=0,W+="<td>"+w[s]+"</td>\n",k+="<td>0</td>\n";C.innerHTML="<tr>\n"+W+"</tr> <tr>\n"+k,O.appendChild(C),document.body.append(N),document.body.append(O),D(N),D(O);var P,U=document.createElement("style");function D(e){var n=0,t=0,l=0,o=0;function s(e){e.toElement!==O&&((e=e||window.event).preventDefault(),l=e.clientX,o=e.clientY,document.onmouseup=i,document.onmousemove=r)}function r(s){(s=s||window.event).preventDefault(),n=l-s.clientX,t=o-s.clientY,l=s.clientX,o=s.clientY,e.style.top=e.offsetTop-t+"px",e.style.left=e.offsetLeft-n+"px"}function i(){document.onmouseup=null,document.onmousemove=null}document.getElementById(e.id+"header")?document.getElementById(e.id+"header").onmousedown=s:e.onmousedown=s}U.innerHTML="\n\tbody {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tbackground-color: #f0f0f0;\n\t\tfont-family: Arial, sans-serif;\n\t\tmargin: 0;\n\t}\n\n\t#tableContainer {\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tbackground-color: #3498db;\n\t\tborder-radius: 5px;\n\t}\n\n\t#tableHeader {\n\t\twidth: 100%;\n\t\tmin-height: 20px;\n\t}\n\n\ttable {\n\t\tbackground-color: #ecf0f1;\n\t\tborder-radius: 5px;\n\t}\n\n\ttd {\n\t\tpadding: 10px;\n\t\ttext-align: center;\n\t}\n\n\t#question {\n\t\tmin-height: 28px;\n\t\tfont-size: 24px;\n\t\tjustify-content: center;\n\t\tbackground-color: #3498db;\n\t\tcolor: white;\n\t\tborder-radius: 5px;\n\t}\n\t",document.head.appendChild(U);var E,z=0,R=0,q=0,H=+new Date,L=!1,j=0,F=!1,Y=[];P=setInterval((function e(){if(0===q&&0===G&&!F&&g&&(H=+new Date),L||(g?(" "===v[z][R][q]||"\n"===v[z][R][q]?N.textContent=" ":N.textContent+=v[z][R][q],q++):N.textContent!==v[z][R]&&(H=+new Date,N.textContent=v[z][R])),q>=v[z][R].length&&g){L=!0,N.textContent="",N.style.minWidth="240px",async function(){if(clearInterval(P),await new Promise((e=>setTimeout(e,2e3))),!F)return 0===X.length&&q>=v[z][R].length&&(N.textContent="Seeing no buzzes, I will repeat the question",await new Promise((e=>setTimeout(e,1e3))),N.textContent=""),q=0,F=!0,L=!1,N.style.minWidth="",P=setInterval(e,f),Promise.resolve("Repeating the Question");var n=5,t=setInterval((function(){if(F)if(n<=0){clearInterval(t),N.textContent="Calling time...";(async()=>{if(await new Promise((e=>setTimeout(e,1e3))),0===X.length)return P=setInterval(e,f),F=!1,$(),Promise.resolve("Calling Time");for(var n=[],t=0;t<x.length;t++)-1===M.indexOf(x[t])&&n.push(x[t]);for(t=0;t<x.length;t++)void 0===X[t]&&(X[t]="Did not Answer",M.push(n[0]),n.splice(0,1));F=!1,R++,K(),P=setInterval(e,f),Promise.resolve("Resolved")})()}else N.textContent="I will call time in "+n.toString()+" seconds";else clearInterval(t),P=setInterval(e,f);n=(n-.1).toFixed(1)}),100)}()}}),f);var M=[],X=[],G=0;document.addEventListener("keypress",(function(e){!function(e){if("s"===e.key.toLowerCase()){var n=prompt("There are "+v.length+" questions in this question set. Where would you like to skip to?\n(Question Number) or (Round, Question Number)");-1===n.indexOf(",")?(z=Number(n)-2,$()):(n=n.split(","),z=20*Number(n[0]-1)+(Number(n[1])-2),$())}else if("d"===e.key.toLowerCase())g=!g,N.textContent="";else if("f"===e.key.toLowerCase()){for(var t="",l=0;l<w.length;l++){var o;try{o=(A[l].reduce(((e,n)=>e+n))/A[l].length).toFixed(1)+" seconds"}catch{o="Has yet to buzz :("}t+=w[l]+": "+o+"\n"}alert(t)}else for(M[G]=e.key.toLowerCase(),l=0;l<w.length;l++)if(e.key.toLowerCase()===T[l])M[G]=x[l],++j===w.length?($(),j=0):(X[l]="Skipped This Question",++G===w.length&&(j=0,R<v[z].length-1?(R++,K()):$()));else if(e.key.toLowerCase()===x[l]){L=!0,j=0;var s=+new Date;Y[G]=(s-H)/1e3,A[l].push(Y[G]),X[l]=prompt("Team "+w[l]+" has buzzed. What is your answer?"),H+=+new Date-s,++G===w.length?R<v[z].length-1?(R++,K()):$():G>w.length?(console.error("Excess presses. The last press performed was from "+w[l]),$()):L=!1}}(e)}));var J=[];for(s=0;s<w.length;s++)J[s]=w[s]+" is "+(s+1)+" (key "+x[s]+")";function K(){F=!1;var e=[],n=v[z][R];n.endsWith("\n\n")||(n+="\n\n");for(var t=0;t<w.length;t++)e[t]=X[x.indexOf(M[t])]+" (Team "+w[x.indexOf(M[t])]+") ("+Y[t]+" seconds)";var l=prompt(n+"The answers provided were (in order)\n"+e.join("\n")+"\n\nWhat team got it right?\n"+J).toLowerCase();if(0===l||""===l){var o=m;R<v[z].length-2&&!o&&(o=confirm("Play bonus as tossup?")),o?V():$()}else if("p"===l){var s=prompt("What team(s) should points be awarded to (Number, Points)?");s=s.split(",");for(t=0;t<s.length;t++)t%2==0&&(Q[s[t]-1]+=Number(s[t+1]),Z());o=m;R<v[z].length-2&&!o&&(o=confirm("Play bonus as tossup?")),o?V():$()}else l=Number(l)-1,Q[l]+=E?5:10,R<v[z].length-2?y?V():function(e){R++;var n=prompt(v[z][R]);R++;var t=v[z][R];t.endsWith("\n\n")||(t+="\n\n");var l=confirm(t+"Your answer: "+n+"\nDid you get it right?");l&&(Q[e]+=5);R<v[z].length-2&&(R++,n=prompt(v[z][R]),R++,(l=confirm(v[z][R]+"\n\nYour answer: "+n+"\nDid you get it right?"))&&(Q[e]+=5));$()}(l):$()}function V(){R<v[z].length-2?(E=!0,R++,q=0,Y=[],M=[],X=[],G=0,N.textContent="",N.style.minWidth="",L=!1):$()}function Z(){for(var e=0;e<w.length;e++)document.getElementsByTagName("td")[document.getElementsByTagName("td").length/2+e].innerText=Q[e]}function $(){if(Z(),E=!1,++z===v.length)return clearInterval(P),void function(){N.innerText="The game is now finished. Congratulations!",W=W.split("\n"),k=k.split("\n");for(var e=Math.max.apply(null,Q),n=0,t=0;t<w.length;t++)Q[t]===e&&(W[t]='<td style="color: gold">'+w[t]+"</td>\n",k[t]='<td style="color: gold">'+Q[t]+"</td>\n",n++);if(1===n&&w.length>1){var l=[...new Set(Q)].sort(((e,n)=>n-e))[1];for(t=0;t<w.length;t++)Q[t]===l&&(W[t]='<td style="color: silver">'+w[t]+"</td>\n",k[t]='<td style="color: silver">'+Q[t]+"</td>\n",n++)}if(2===n&&w.length>2){var o=[...new Set(Q)].sort(((e,n)=>n-e))[2];for(t=0;t<w.length;t++)Q[t]===o&&(W[t]='<td style="color: brown">'+w[t]+"</td>\n",k[t]='<td style="color: brown">'+Q[t]+"</td>\n")}var s=[];for(t=0;t<w.length;t++)A[t].length>0?s[t]=A[t].reduce(((e,n)=>e+n))/A[t].length:s[t]=-1;var r=Math.min.apply(null,s.filter((function(e){return-1!=e})));for(t=0;t<w.length;t++)s[t]===r&&(4===W[t].indexOf('style="')?W[t]=W[t].replace('style="','style="background-color: white; '):W[t]='<td style="background-color: white">'+w[t]+"</td>\n");W=W.join(""),k=k.join(""),C.innerHTML="<tr>\n"+W+"</tr> <tr>\n"+k,C.style.backgroundColor="black"}();R=0,q=0,Y=[],M=[],X=[],G=0,N.textContent="",N.style.minWidth="",L=!1}J=J.join("\n")}
</script></head><body><center><button onclick="start()">Click me!</button></center></body></html>